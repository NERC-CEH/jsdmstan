<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Fitting jSDMs in Stan • jsdmstan</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/Montserrat-0.4.9/font.css" rel="stylesheet">
<link href="deps/Roboto_Mono-0.4.9/font.css" rel="stylesheet">
<link href="deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Fitting jSDMs in Stan">
<meta name="description" content="This package is for fitting joint Species Distribution Models (jSDMs) in Stan, and has functions for simulating jSDM data and fitting jSDM data according to the generalised linear latent variable model (GLLVM) or multivariate generalised linear mixed model (MGLMM).">
<meta property="og:description" content="This package is for fitting joint Species Distribution Models (jSDMs) in Stan, and has functions for simulating jSDM data and fitting jSDM data according to the generalised linear latent variable model (GLLVM) or multivariate generalised linear mixed model (MGLMM).">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">jsdmstan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/jsdmstan.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="jsdmstan-joint-species-distribution-models-in-stan">jsdmstan: joint Species Distribution Models in Stan<a class="anchor" aria-label="anchor" href="#jsdmstan-joint-species-distribution-models-in-stan"></a>
</h1></div>
<!-- badges: start -->

<p>This is an R package for running joint Species Distribution Models (jSDM) in <a href="https://mc-stan.org/" class="external-link">Stan</a>. jSDMs are models where multiple response variables (i.e. species) are fit at the same time, and the covariance between these species are used to inform the model results. For a review of jSDMs see Warton et al. (2015) So many variables: joint modelling in community ecology. <em>TREE</em>, 30:766-779 DOI: <a href="http://doi.org/10.1016/j.tree.2015.09.007" class="external-link">10.1016/j.tree.2015.09.007</a>.</p>
<p>This package can fit data to a Multivariate Generalised Linear Mixed Model (MGLMM) or a Generalised Linear Latent Variable Model (GLLVM), and also provides functionality for simulating data under these scenarios and an interface to the <a href="https://mc-stan.org/bayesplot/" class="external-link">bayesplot</a> package for a wide variety of plotting options.</p>
</div>
<div class="section level1">
<h1 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h1>
<p>This package can be installed using the <a href="https://remotes.r-lib.org/index.html" class="external-link">remotes</a> package using the following code:</p>
<pre><code><span><span class="co"># install.packages("remotes")</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"NERC-CEH/jsdmstan"</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level1">
<h1 id="using-jsdmstan">Using jsdmstan<a class="anchor" aria-label="anchor" href="#using-jsdmstan"></a>
</h1>
<p>Example code:</p>
<pre><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nerc-ceh.github.io/jsdmstan/">jsdmstan</a></span><span class="op">)</span></span></code></pre>
<p>Simulate data:</p>
<pre><code><span><span class="va">nsites</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span><span class="va">nspecies</span> <span class="op">&lt;-</span> <span class="fl">9</span></span>
<span><span class="va">ncovar</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">mglmm_test_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/jsdm_sim_data.html">mglmm_sim_data</a></span><span class="op">(</span>N <span class="op">=</span> <span class="va">nsites</span>, S <span class="op">=</span> <span class="va">nspecies</span>,</span>
<span>                                  K <span class="op">=</span> <span class="va">ncovar</span>, family <span class="op">=</span> <span class="st">"pois"</span><span class="op">)</span></span></code></pre>
<p>Fit Stan model:</p>
<pre><code><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">mglmm_test_data</span><span class="op">$</span><span class="va">X</span><span class="op">)</span></span>
<span><span class="va">mglmm_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/stan_jsdm.html">stan_jsdm</a></span><span class="op">(</span><span class="op">~</span> <span class="va">V1</span> <span class="op">+</span> <span class="va">V2</span>, data <span class="op">=</span> <span class="va">dat</span>, Y <span class="op">=</span> <span class="va">mglmm_test_data</span><span class="op">$</span><span class="va">Y</span>,</span>
<span>                       family <span class="op">=</span> <span class="st">"pois"</span>, method <span class="op">=</span> <span class="st">"mglmm"</span><span class="op">)</span></span></code></pre>
<p>Plot results:</p>
<pre><code><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mglmm_fit</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/mcmc_plot.jsdmStanFit.html">mcmc_plot</a></span><span class="op">(</span><span class="va">mglmm_fit</span>, plotfun <span class="op">=</span> <span class="st">"rhat_hist"</span><span class="op">)</span></span></code></pre>
<hr>
<p>This work was funded by the Natural Environment Research Council (part of UK Research and Innovation) under the UK-SCAPE Programme delivering National Capability (Grant Reference NE/R016429/1).</p>
<p><img src="./reference/figures/UKCEH-Logo.png" alt="UKCEH logo"><img src="./reference/figures/uk_scape_logo.png" alt="UKSCAPE logo"></p>
</div>

  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing jsdmstan</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Fiona Seaton <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-2022-7451" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/NERC-CEH/jsdmstan/actions" class="external-link"><img src="https://github.com/NERC-CEH/jsdmstan/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://codecov.io/gh/NERC-CEH/jsdmstan?branch=main" class="external-link"><img src="https://codecov.io/gh/NERC-CEH/jsdmstan/branch/main/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Fiona Seaton.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
